---
title: 'CA1003: Use generic event handler instances'
ms.date: 03/11/2019
ms.topic: reference
f1_keywords:
- UseGenericEventHandlerInstances
- CA1003
helpviewer_keywords:
- CA1003
- UseGenericEventHandlerInstances
ms.assetid: 402101b6-555d-4cf7-b223-1d9fdfaaf1cd
author: mikejo5000
ms.author: mikejo
manager: jillfra
dev_langs:
- CSharp
- VB
ms.workload:
- multiple
---
# CA1003: Use generic event handler instances

|Item|Value|
|-|-|
|CheckId|CA1003|
|Category|Microsoft.Design|
|Breaking change|Breaking|

## Cause

A type contains a delegate that returns void and whose signature contains two parameters (the first an object and the second a type that is assignable to EventArgs), and the containing assembly targets .NET.

By default, this rule only looks at externally visible types, but this is [configurable](#configurability).

## Rule description

Before .NET Framework 2.0, in order to pass custom information to the event handler, a new delegate had to be declared that specified a class that was derived from the <xref:System.EventArgs?displayProperty=fullName> class. In .NET Framework 2.0 and later versions, the generic <xref:System.EventHandler%601?displayProperty=fullName> delegate allows any class that's derived from <xref:System.EventArgs> to be used together with the event handler.

## How to fix violations

To fix a violation of this rule, remove the delegate and replace its use by using the <xref:System.EventHandler%601?displayProperty=fullName> delegate.

If the delegate is autogenerated by the Visual Basic compiler, change the syntax of the event declaration to use the <xref:System.EventHandler%601?displayProperty=fullName> delegate.

## When to suppress warnings

Do not suppress a warning from this rule.

## Configurability

If you're running this rule from [FxCop analyzers](install-fxcop-analyzers.md) (and not with legacy analysis), you can configure which parts of your codebase to run this rule on, based on their accessibility. For example, to specify that the rule should run only against the non-public API surface, add the following key-value pair to an .editorconfig file in your project:

```ini
dotnet_code_quality.ca1003.api_surface = private, internal
```

You can configure this option for just this rule, for all rules, or for all rules in this category (Design). For more information, see [Configure FxCop analyzers](configure-fxcop-analyzers.md).

## Example

The following example shows a delegate that violates the rule. In the Visual Basic example, comments describe how to modify the example to satisfy the rule. For the C# example, an example follows that shows the modified code.

[!code-vb[FxCop.Design.CustomEventHandler#1](../code-quality/codesnippet/VisualBasic/ca1003-use-generic-event-handler-instances_1.vb)]
[!code-csharp[FxCop.Design.CustomEventHandler#1](../code-quality/codesnippet/CSharp/ca1003-use-generic-event-handler-instances_1.cs)]

The following code snippet removes the delegate declaration from the previous example, which satisfies the rule. It replaces its use in the `ClassThatRaisesEvent` and `ClassThatHandlesEvent` methods by using the <xref:System.EventHandler%601?displayProperty=fullName> delegate.

[!code-csharp[FxCop.Design.GenericEventHandler#1](../code-quality/codesnippet/CSharp/ca1003-use-generic-event-handler-instances_2.cs)]

## Related rules

- [CA1005: Avoid excessive parameters on generic types](../code-quality/ca1005.md)
- [CA1010: Collections should implement generic interface](../code-quality/ca1010.md)
- [CA1000: Do not declare static members on generic types](../code-quality/ca1000.md)
- [CA1002: Do not expose generic lists](../code-quality/ca1002.md)
- [CA1006: Do not nest generic types in member signatures](../code-quality/ca1006.md)
- [CA1004: Generic methods should provide type parameter](../code-quality/ca1004.md)
- [CA1007: Use generics where appropriate](../code-quality/ca1007.md)

## See also

- [Generics](/dotnet/csharp/programming-guide/generics/index)
