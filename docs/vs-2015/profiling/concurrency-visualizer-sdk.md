---
title: "Concurrency Visualizer SDK | Microsoft Docs"
ms.date: 11/15/2016
ms.prod: "visual-studio-dev14"
ms.technology: "vs-ide-debug"
ms.topic: conceptual
f1_keywords:
  - "vs.cv.sdk.about"
ms.assetid: 4b22cdf9-59b1-4c88-a6d8-1644a4a11e08
caps.latest.revision: 16
author: MikeJo5000
ms.author: mikejo
manager: jillfra
---
# Concurrency Visualizer SDK
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

You can instrument your source code by using the Concurrency Visualizer SDK to display additional information in the Concurrency Visualizer. You can associate the additional data with phases and events in your code. These additional visualizations are known as *markers*.  For an introductory walkthrough, see [Introducing the Concurrency Visualizer SDK](https://docs.microsoft.com/archive/blogs/visualizeparallel/introducing-the-concurrency-visualizer-sdk).

## Properties
 Flags, spans, and messages each have two properties: category and importance. In the [Advanced Settings](../profiling/advanced-settings-dialog-box-concurrency-visualizer.md) dialog box, you can use these properties to filter the set of markers that are displayed. In addition, these properties affect the visual representation of markers. For example, the size of flags is used to represent importance. In addition, color is used to indicate category.

## Basic Usage
 The Concurrency Visualizer exposes a default provider that you can use to generate markers. The provider is already registered together with the Concurrency Visualizer and you don't have to do anything else to make the markers appear in the UI.

### C# and Visual Basic

In C#, Visual basic, and other managed code, use the default provider by calling methods in the [Markers](/previous-versions/hh694099(v=vs.140)) class. It exposes four methods for generating markers: [WriteFlag](/previous-versions/hh694185(v=vs.140)), [EnterSpan](/previous-versions/hh694205(v=vs.140)), [WriteMessage](/previous-versions/hh694161(v=vs.140)), and [WriteAlert](/previous-versions/hh694180(v=vs.140)). There are multiple overloads for these functions, depending on whether you want to use defaults for the properties.  The simplest overload takes only a string parameter that specifies the description of the event. The description is displayed in the Concurrency Visualizer reports.

#### Add SDK support to a C# or Visual Basic project

1. On the menu bar, choose **Analyze**, **Concurrency Visualizer**, **Add SDK to project**.

2. Select the project in which you want to access the SDK and then choose the **Add SDK to Selected Project** button.

3. Add an imports or using statement to your code.

    ```csharp
    using Microsoft.ConcurrencyVisualizer.Instrumentation;
    ```

    ```vb
    Imports Microsoft.ConcurrencyVisualizer.Instrumentation
    ```

### C++
 In C++, create a [marker_series Class](../profiling/marker-series-class.md) object and use it to call functions.  The `marker_series` class exposes three functions for generating markers, the [marker_series::write_flag Method](../profiling/marker-series-write-flag-method.md), the [marker_series::write_message Method](../profiling/marker-series-write-message-method.md), and the [marker_series::write_alert Method](../profiling/marker-series-write-alert-method.md).

##### To add SDK support to a C++ or C project

1. On the menu bar, choose **Analyze**, **Concurrency Visualizer**, **Add SDK to project**.

2. Select the project in which you want to access the SDK and then choose the **Add SDK to Selected Project** button.

3. For C++, include `cvmarkersobj.h`. For C, include `cvmarkers.h`.

4. Add a using statement to your code.

    ```cpp
    using namespace Concurrency::diagnostic;
    ```

5. Create a `marker_series` object and pass it to the `span` constructor.

    ```cpp
    marker_series mySeries;
    span s(mySeries, _T("Span description"));
    ```

## Custom Usage
 For advanced scenarios, the Concurrency Visualizer SDK exposes more control. Two main concepts are associated with more advanced scenarios: marker providers and marker series. Marker providers are different ETW providers (each has a different GUID). Marker series are serial channels of events that are generated by one provider. You can use them to organize the events that are generated by a marker provider.

#### To use a new marker provider in a C# or Visual Basic project

1. Create a [MarkerWriter](/previous-versions/hh694138(v=vs.140)) object. The constructor takes a GUID.

2. To register the provider, open the Concurrency Visualizer [Advanced Settings](../profiling/advanced-settings-dialog-box-concurrency-visualizer.md) dialog box.  Select the **Markers** tab and then choose the **Add New Provider** button. In the [Advanced Settings](../profiling/advanced-settings-dialog-box-concurrency-visualizer.md) dialog box, enter the GUID that was used to create the provider and a description of the provider.

#### To use a new marker provider in a C++ or C project

1. Use the `CvInitProvider` function to initialize a PCV_PROVIDER. The constructor takes a GUID* and PCV_PROVIDER\*.

2. To register the provider, open the [Advanced Settings](../profiling/advanced-settings-dialog-box-concurrency-visualizer.md) dialog box. Select the **Markers** tab and then choose the **Add New Provider** button. In this dialog box, enter the GUID that was used to create the provider and a description of the provider.

#### To use a marker series in a C# or Visual Basic project

1. To use a new [MarkerSeries](/previous-versions/hh694127(v=vs.140)), first create it by using a [MarkerWriter](/previous-versions/hh694138(v=vs.140)) object, and then generate marker events directly from the new series.

    ```csharp
    MarkerSeries series1 = myMarkerWriter.CreateMarkerSeries(″Series 1″);
    series1.WriteFlag(″My flag″);
    ```

    ```vb
    Dim series1 As New myMarkerWriter.CreateMarkerSeries(″Series 1″)
    series1.WriteFlag(″My flag″)
    ```

#### To use a marker series in a C++ project

1. Create a `marker_series` object.  You can generate events from this new series.

    ```scr
    marker_series series;
    series.write_flag(_T("Hello world!"));
    ```

#### To use a marker series in a C project

1. Use the `CvCreateMarkerSeries` function to create a PCV_MARKERSERIES.

    ```cpp
    PCV_MARKERSERIES series;
    CvCreatemarkerSeries(myProvider, _T("My Series"), &series);
    CvWriteFlag(series, _T("Writing a flag"));
    ```

## Related Topics

|Title|Description|
|-----------|-----------------|
|[C++ Library Reference](../profiling/cpp-library-reference.md)|Describes the Concurrency Visualizer API for C++.|
|[C Library Reference](../profiling/c-library-reference.md)|Describes the Concurrency Visualizer API for C.|
|[Instrumentation](/previous-versions/hh694104(v=vs.140))|Describes the Concurrency Visualizer API for managed code.|
|[Concurrency Visualizer](../profiling/concurrency-visualizer.md)|Reference information for the views and reports of profiling data files that are generated by using the concurrency method and that include thread execution data.|
