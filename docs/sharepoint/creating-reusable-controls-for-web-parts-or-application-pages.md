---
title: "Creating Reusable Controls for Web Parts or Application Pages | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "user controls [SharePoint development in Visual Studio], creating"
  - "SharePoint development in Visual Studio, user controls"
ms.assetid: 8fcafd98-c002-47f1-b4a9-cbb500232616
caps.latest.revision: 19
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
---
# Creating Reusable Controls for Web Parts or Application Pages
  In Visual Studio, you can create custom, reusable controls that can be consumed by application pages and Web Parts that run in SharePoint. These controls are called user controls. For more information about user controls, see [ASP.NET User Controls](../Topic/ASP.NET%20User%20Controls.md).  
  
## Creating a User Control  
 To create a user control, add a **User Control** to an **Empty SharePoint Project**. For more information, see [How to: Create a User Control for a SharePoint Application Page or Web Part](../sharepoint/how-to-create-a-user-control-for-a-sharepoint-application-page-or-web-part.md).  
  
 When you add a **User Control** item, Visual Studio creates a folder in your project, and then adds several files to the folder. The following table describes each file.  
  
|File|Description|  
|----------|-----------------|  
|User control file|Defines the user control. Design the user control by adding controls and markup to this file.|  
|Code file|Contains code behind the user control. Add code to handle events to this file.|  
|Designer code file|Contains code generated by the designer and should not be directly edited.|  
  
## Designing the User Control  
 Design the user control by using the Visual Web Developer designer in Visual Studio. This designer appears when you open the user control file in your project and choose the **Design** tab. For more information about using this designer, see [Visual Studio Web Development Content Map](http://msdn.microsoft.com/en-us/9c31f93b-c8fb-4599-9b14-6194ec8c7539).  
  
## Consuming the User Control  
 User controls do not appear in SharePoint until you include them in an application page or a Web Part.  
  
 To include a user control in an application page add an [@ Register](http://msdn.microsoft.com/en-us/66f34922-be41-4e36-9dc8-1774d85311d1) directive to the application page, and then declare the user control inside of one or more content placeholders in the page. For an example of how to accomplish this task in a standard ASP.NET Web page, see [How to: Include a User Control in an ASP.NET Web Page](../Topic/How%20to:%20Include%20a%20User%20Control%20in%20an%20ASP.NET%20Web%20Page.md).  
  
 To include a user control in a Web Part, add the user control to the Web Part <xref:System.Web.UI.WebControls.WebParts.Part.Controls%2A> collection in the Web Part code file. The following example adds a user control to the <xref:System.Web.UI.WebControls.WebParts.Part.Controls%2A> collection of a Web Part.  
  
 [!code-vb[SP_VisualWebPart#5](../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1.vb#5)]
 [!code-cs[SP_VisualWebPart#5](../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1.cs#5)]  
  
## Debugging a User Control  
 To debug a user control, ensure that the user control is included in an application page or Web Part in your SharePoint project. You can then debug code in the user control just as you would debug code in any Visual Studio Project.  
  
 When you start the Visual Studio debugger, Visual Studio opens the SharePoint site.  
  
 In SharePoint, open the application page that includes the user control. If the user control is included in a Web Part, add the Web Part to a Web Part page in SharePoint.  
  
 For more information about debugging SharePoint projects, see [Troubleshooting SharePoint Solutions](../sharepoint/troubleshooting-sharepoint-solutions.md).  
  
## Related Topics  
  
|Title|Description|  
|-----------|-----------------|  
|[How to: Create a User Control for a SharePoint Application Page or Web Part](../sharepoint/how-to-create-a-user-control-for-a-sharepoint-application-page-or-web-part.md)|Shows you how to create custom, reusable controls that can be consumed by application pages and Web Parts that run in SharePoint.|  
|[Working with Visual Web Developer](http://msdn.microsoft.com/en-us/9c31f93b-c8fb-4599-9b14-6194ec8c7539)|Describes how to use the designer that appears when you open a Web page in your project.|  
  
  